name: Lint & TS

on:
  pull_request:
    branches: ['*']
  pull_request_target:
    branches: ['*']
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
      - uses: pnpm/action-setup@v2
        name: pnpm setup
        with:
          version: 8
      - name: Use Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20.5'
          cache: 'pnpm'
      - name: pnpm install
        run: |
          pnpm install
      - name: Run lint-staged
        run: |
          pnpm exec lint-staged --diff="origin/${GITHUB_BASE_REF}...origin/${GITHUB_HEAD_REF}"
